<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
<button id="btn">回退</button>
<div class="navbar">
  <a href="#/home">首页</a>
  <a href="#/about">关于</a>
  <a href="#/404">404</a>
</div>
<div id="app">
  default
</div>
<script type="module">
  const app = document.querySelector('#app')
  const links = document.querySelectorAll('a')

  // 循环为所有的a绑定点击事件
  for (let link of links) {
    link.addEventListener('click', (e) => {
      // 阻止默认行为
      e.preventDefault()
      let href = link.getAttribute('href')
      // 改变url地址，此时内容页面其他内容不发生改变
      history.pushState({}, '', href)
      // 当pushstate后，触发事件进行匹配
      renderView()
    })
  }

  // 需要在调用 back、go、forward时才会触发
  window.addEventListener('popstate', () => {
    console.log(123)
    renderView()
  })
  // 测试回退
  document.querySelector('#btn').addEventListener('click', () => {
    history.back()
  })

  function renderView () {
    switch (location.hash) {
      case '#/home':
        app.innerHTML = 'Home'
        break
      case '#/about':
        app.innerHTML = 'About'
        break
      default:
        app.innerHTML = 'default'
    }
  }
  renderView()
</script>
</body>
</html>